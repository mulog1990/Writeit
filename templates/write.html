{% extends "base.html" %}

{% block head %}
  <link rel="stylesheet" href="{{ static_url("editor.css") }}"/>
{% end %}

{% block body %}

<div id="write-bg">
<div id="editor">
      <form name="editor-form" action="#" method="post">
      {% raw xsrf_form_html() %}
      <input name="title" type="text" class="form-control" id="title-input" value="{{ entry["title"] if entry else ""}}" placeholder="{{ "Title" if not entry else "" }}"></input>
      <textarea id="markdown-input" name="markdown" rows="20" class="form-control">{{ entry["markdown"] if entry else "" }}</textarea>
      <div id="button-row">
        <input value="Preview" class="btn btn-primary" id="editor-preview" onclick="showHtml()">
        <input type="submit" value="Submit" class="btn btn-success" id="editor-submit"> 
      </div>
      </form>
</div> 
</div>



<div class="modal fade" id="previewModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
        <h4 class="modal-title" id="myModalLabel">Html Preview</h4>
      </div>
      <div class="modal-body">
        ...
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
      </div>
    </div><!-- /.modal-content -->
  </div><!-- /.modal-dialog -->
</div><!-- /.modal -->

{% end %}

{% block script %}
  <script type="text/javascript">
  
  function showHtml() {
    $.post("parse",
      {
        _xsrf: $("input[name='_xsrf'").val(),
        markdown: "#" + $("#title-input").val() + "\n" +
          $("#markdown-input").val()
      },
      function(data, status) {
        $(".modal-body").html(data);
         $("#previewModal").modal('toggle');
      }
    );
  }
  </script>
{% end %}

